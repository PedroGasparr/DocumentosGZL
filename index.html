<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Documentos</title>
    <link rel="icon" href="img/GZL - Logos_pages-to-jpg-0001.jpg">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Página de Login -->
    <div id="loginContainer">
        <div class="login-box">
            <div style="text-align: center; margin-bottom: 20px;">
                <img src="img/GZL - Logos_pages-to-jpg-0001.jpg" alt="Logo da Empresa" class="logo">
            </div>
            <h1>Sistema de Documentos</h1>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" required>
                </div>
                <div class="form-group">
                    <label for="senha">Senha</label>
                    <input type="password" id="senha" required>
                </div>
                <button type="submit" class="btn">Entrar</button>
            </form>
        </div>
    </div>

    <!-- Sistema Principal (inicialmente oculto) -->
    <div id="appContainer" style="display: none;">
        <header>
            <div class="header-content">
                <div class="logo-container">
                    <img src="img/GZL - Logos_pages-to-jpg-0001.jpg" alt="Logo da Empresa" class="logo">
                    <h1>Sistema de Documentos</h1>
                </div>
                <nav>
                    <button class="nav-btn active" data-page="cadastro">Cadastrar</button>
                    <button class="nav-btn" data-page="funcionarios" id="funcionariosBtn">Funcionários</button>
                    <button class="nav-btn" data-page="controlePessoas" id="controlePessoasBtn">Controle de Pessoas</button>
                    <button id="logoutBtn">Sair</button>
                </nav>
            </div>
        </header>

        <!-- Página de Cadastro -->
        <div id="cadastro" class="container active">
            <div id="statusMessage" class="status-message"></div>
            
            <h2>Cadastro de Documentos</h2>
            <div class="form-row">
                <div class="form-group">
                    <label for="nome">Nome Completo</label>
                    <input type="text" id="nome" list="nomesFuncionarios" required placeholder="Digite o nome ou selecione">
                    <datalist id="nomesFuncionarios">
                        <option value="ADAUTON CAMPOS">
                        <option value="ADEMIR MORAES DE LIMA">
                        <option value="ADEMIR PEREIRA DA SILVA">
                        <option value="ADRIANO CHAVES DE SOUZA">
                        <option value="ALEFF BAPTISTA ELLER">
                        <option value="ALEXANDRE CHAVES">
                        <option value="ALEXANDRE FERNANDES DE OLIVEIRA">
                        <option value="ALEXSANDRO FARIA PEREIRA CARLETE">
                        <option value="ALEXANDRO DA SILVA LIMA">
                        <option value="ALEXSANDRO SILVA SANTOS">
                        <option value="ALLAN FERNANDES DA SILVA">
                        <option value="ANA PAULA DA SILVA">
                        <option value="ANDRE LUIS FERREIRA">
                        <option value="ANDRE LUIZ RODRIGUES">
                        <option value="ANDRE MARCELO REIS ALENCAR">
                        <option value="ANDREANS ANDRE DOS SANTOS">
                        <option value="ANDREY CARDOSO DA SILVA">
                        <option value="ANISIO BUSCARINI">
                        <option value="ANTONIO AFONSO DE QUEIROZ FILHO">
                        <option value="ANTONIO CEZAR DA CUNHA JUNIOR">
                        <option value="BENEDITO DONIZETI DE OLIVEIRA">
                        <option value="BRENO HENRIQUE PASIN FAUSTINO">
                        <option value="BRUNO FERNANDES DA SILVA">
                        <option value="BRUNO HENRIQUE DA CRUZ LISBOA">
                        <option value="BRUNO JOSE RAMALHO">
                        <option value="CAMILO DE OLIVEIRA DOS SANTOS">
                        <option value="CARLOS LUIZ DE FARIA">
                        <option value="CAUE LUIZ">
                        <option value="CLAUDINEI ALVES DE OLIVEIRA">
                        <option value="CLAYTON LOURENCO DOS SANTOS">
                        <option value="CLEYTON OLIVEIRA DA SILVA">
                        <option value="CLOVIS SEBASTIAO BRUNO">
                        <option value="DAIANA APARECIDA SANTOS SILVA">
                        <option value="DANIEL SANTOS DE CARVALHO">
                        <option value="DANILO DE MATOS LOPES">
                        <option value="DAVID ALMEIDA PASCOAL">
                        <option value="DEIVID ALLAN CASTRO DE MATOS">
                        <option value="DIOGO COSTA DE ANDRADE">
                        <option value="DIOGO LUIZ SILVA WEBER">
                        <option value="DOUGLAS ALEXANDRE MARTINS">
                        <option value="DOUGLAS HIDEO TANAKA PEREIRA">
                        <option value="EDERSON APARECIDO AZEVEDO ANTUNES">
                        <option value="EDMILSON DOS SANTOS">
                        <option value="ELIAS ALVES SOARES">
                        <option value="ELIEL MIRANDA SILVA">
                        <option value="ELIZABETH RODRIGUES CLARO">
                        <option value="EMERSON TEODORO">
                        <option value="ERICA SIMONE JOSE DOS SANTOS">
                        <option value="ERICK OLIVEIRA ALVES">
                        <option value="ERIK ALVES SAMUEL">
                        <option value="FABIO NASCIMENTO VANUCCI">
                        <option value="FLAVIO RODRIGUES">
                        <option value="FELIPE ANTONIO DUTRA EVANGELISTA">
                        <option value="FELIPE EDUARDO ROCHALO DE MATOS">
                        <option value="FELIPE RAFAEL PRADO MATIAS">
                        <option value="FERNANDO ALISSON ALMEIDA CAMARGO">
                        <option value="FERNANDO ALVES SANTOS">
                        <option value="FLAVIO RODRIGUES (PCD)">
                        <option value="FRANCISCO EROLES JUNIOR">
                        <option value="GABRIEL ANDREW DA SILVA">
                        <option value="GABRIEL APARECIDO MORAES DE SOUZA - ADM">
                        <option value="GABRIEL SANDRI DOMINGUES">
                        <option value="GIOVANNI JOSE DOS SANTOS PRADO">
                        <option value="GUILHERME DE OLIVEIRA FERREIRA">
                        <option value="GUILHERME MATHEUS DA SILVA">
                        <option value="GUSTAVO LIMA DOS SANTOS">
                        <option value="HENRIQUE GOMES FERREIRA">
                        <option value="HENRIQUE RAFAEL DE OLIVEIRA BRAGA">
                        <option value="HENRIQUE RODRIGUES JIMPON HU">
                        <option value="HENRRI NICOLAS DE JESUS ROSA">
                        <option value="HIAGO LINCON CUBAS SIQUEIRA SILVA">
                        <option value="HIGOR APARECIDO DA SILVA">
                        <option value="ISAIAS MARIANO DE SOUZA">
                        <option value="JANDERSON CAMARGO">
                        <option value="JEFERSON DE SOUZA SOARES">
                        <option value="JESSE DE SOUZA MELLO">
                        <option value="JIULY GUSTAVO MAIA MILITAO">
                        <option value="JOAO JOEL MENDES">
                        <option value="JOAO PEDRO CARVALHO DOS SANTOS">
                        <option value="JOAO PEDRO SILVEIRA">
                        <option value="JOAO VICTOR RODRIGUES SILVA">
                        <option value="JOAO VITOR ALMEIDA DOS SANTOS">
                        <option value="JONATHAN HENRIQUE SIQUEIRA DO NASCIMENTO">
                        <option value="JONATHAN SULIVAN DAS NEVES">
                        <option value="JOSE APOLINARIO">
                        <option value="JOSE CARLOS ALVES LINS (PCD)">
                        <option value="JOSE CARLOS DE SOUZA">
                        <option value="JOSE JONATAS DOS SANTOS COSTA">
                        <option value="JULIO CEZAR DOS SANTOS">
                        <option value="JULIO DA SILVA PINTO">
                        <option value="KAUAN DE SOUZA FARIAS">
                        <option value="KAUE SILVA DE PAULA">
                        <option value="KENEDY DE OLIVEIRA">
                        <option value="KLEBERSON PEREIRA DOS SANTOS">
                        <option value="LEANDRO FERREIRA DA SILVA">
                        <option value="LEANDRO FERREIRA DE OLIVEIRA">
                        <option value="LEONARDO DA SILVA COSTA">
                        <option value="LEONARDO GODOY DOS SANTOS">
                        <option value="LEONARDO VASCONCELOS DO PRADO">
                        <option value="LUCAS DA SILVA PASSOS">
                        <option value="LUCAS DE OLIVEIRA ANDRADE">
                        <option value="LUCAS GABRIEL DA SILVA">
                        <option value="LUCAS MONTEIRO VASCONCELOS">
                        <option value="LUIS FABIANO APARECIDO ORTIZ DAS NEVES">
                        <option value="LUIS FELIPE DONIZETI DE SANTANA FERNANDES">
                        <option value="LUIS FERNANDO DE SOUZA MACHADO">
                        <option value="LUIS HENRIQUE DA SILVA">
                        <option value="LUIZ GUSTAVO ALMEIDA DOS SANTOS">
                        <option value="LUIZ HENRIQUE FERNANDES">
                        <option value="LUIZ ROBERTO CARRASCO FRANCO">
                        <option value="MARCELO DA SILVA RODRIGUES">
                        <option value="MARCELO DONIZETTI DOS SANTOS DIAS">
                        <option value="MARCELO GORRERA BRITTO FERNANDES">
                        <option value="MARCIO APARECIDO DE OLIVEIRA">
                        <option value="MARCIO APARECIDO DE OLIVEIRA JUNIOR">
                        <option value="MARCO APARECIDO DAS NEVES">
                        <option value="MARIA BENEDITA BORGES">
                        <option value="MARINES DE MORAES PIRES">
                        <option value="MATEUS FRANCO LEAO SENA">
                        <option value="MATHEUS GUSTAVO SANCHES DE MELO">
                        <option value="MATHEUS KEVIN DA SILVA ALMEIDA">
                        <option value="MATHEUS LOTITO BITTENCOURT">
                        <option value="MERCIA DE SOUZA SANDRI RODRIGUES">
                        <option value="MURILO MAESTRE FERREIRA DOS SANTOS">
                        <option value="NELSON IUSUTI DOS SANTOS">
                        <option value="NICOLAS SILVA DOS SANTOS">
                        <option value="NICOLAS WILTON MONTEIRO">
                        <option value="PAULO GABRIEL">
                        <option value="PAULO HENRIQUE DE OLIVEIRA">
                        <option value="PAULO ROGERIO CALIXTO">
                        <option value="PEDRO DOS SANTOS">
                        <option value="PEDRO HENRIQUE DA SILVA JUNGERS FRANCO">
                        <option value="PETERSON SIMEAO TEIXEIRA">
                        <option value="RAELY CAROLINE DE LIMA PASSOS">
                        <option value="RAFAEL DE GODOY SANTOS">
                        <option value="RAFAEL MARQUES DE PAULA">
                        <option value="RAFAEL RODRIGUES GOMES">
                        <option value="RAPHAEL PEREIRA DOS SANTOS">
                        <option value="REGINALDO BARBOSA DOS SANTOS">
                        <option value="REGINALDO FIRMINO DOS SANTOS JUNIOR">
                        <option value="RENAN OLIVEIRA VIANA">
                        <option value="ROBERT APARECIDO DE OLIVEIRA">
                        <option value="ROBERT SOUZA SILVA">
                        <option value="RODMILSON FELIPE SOUZA LIMA">
                        <option value="RODRIGO APARECIDO TEIXEIRA">
                        <option value="RODRIGO DA SILVA BASTIANELLI">
                        <option value="ROMILSON FLORIANO">
                        <option value="RUBENS TAVARES RODRIGUES JUNIOR">
                        <option value="SAMUEL SALES GONCALVES DOS ANJOS">
                        <option value="SAMUEL WASHINGTON GOMES DOS SANTOS">
                        <option value="SANDRA PEREIRA DE SIQUEIRA DIAS">
                        <option value="SANDRO MARTINS PINTO">
                        <option value="SEBASTIAO ELIAS FEITOZA">
                        <option value="SILVIO DOS SANTOS">
                        <option value="SIMONE APARECIDA DOS SANTOS">
                        <option value="SONIA REGINA OLIVEIRA MARQUES">
                        <option value="TANIA DA SILVA GENIVAL">
                        <option value="TEODORO FERNANDES">
                        <option value="TIAGO DA SILVA MARQUES">
                        <option value="VAGNER ROBERTO DA SILVA">
                        <option value="VALDIR LEMOS DE OLIVEIRA JUNIOR">
                        <option value="VALDIR ROBERTO DE OLIVEIRA">
                        <option value="VALERIA FERNANDES CARVALHO">
                        <option value="VALTAIR APARECIDO LEITE ALVES">
                        <option value="VICTOR HENRIQUE DE SANTANA FERNANDES">
                        <option value="VINICIUS RAFAEL NUNES BARBOSA">
                        <option value="VITOR HENRIQUE DIONISIO PEREIRA">
                        <option value="WAGNER LIMA DE SOUZA">
                        <option value="WEMERSON ALENCAR MENDONCA">
                        <option value="WERISSON SILVA DE ARAUJO">
                        <option value="WESLEI JUNIOR DOS SANTOS DE CAMPOS">
                        <option value="WESLLEY DIAS DA COSTA">
                        <option value="WILLIAN HENRIQUE DINIZ">
                        <option value="WILLIAN JUNIOR CORDEIRO DE CRISTO">
                    </datalist>
                </div>
                <div class="form-group">
                    <label for="cpf">CPF</label>
                    <input type="text" id="cpf" required>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="cargo">Cargo</label>
                    <select id="cargo" required>
                        <option value="">Selecione o cargo</option>
                        <option value="operador">Operador</option>
                        <option value="auxiliar">Auxiliar</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="temDependentes">Possui dependentes?</label>
                    <select id="temDependentes" required>
                        <option value="">Selecione</option>
                        <option value="sim">Sim</option>
                        <option value="nao">Não</option>
                    </select>
                </div>
            </div>

            <div class="section-title" onclick="toggleSection('documentosPessoais')">
                <h3>Documentos Pessoais</h3>
                <span>▼</span>
            </div>
            <div id="documentosPessoais" class="section-content">
                <div class="documento-item">
                    <label for="rg">RG</label>
                    <input type="file" id="rg" accept=".pdf,.jpg,.png" required>
                </div>
                <div class="documento-item">
                    <label for="cpfDoc">CPF (Documento)</label>
                    <input type="file" id="cpfDoc" accept=".pdf,.jpg,.png" required>
                </div>
                <div class="documento-item">
                    <label for="tituloEleitor">Título de Eleitor</label>
                    <input type="file" id="tituloEleitor" accept=".pdf,.jpg,.png" required>
                </div>
                <div class="documento-item">
                    <label for="reservista">Certidão de Reservista</label>
                    <input type="file" id="reservista" accept=".pdf,.jpg,.png" required>
                </div>
            </div>

            <div class="section-title" onclick="toggleSection('documentosFamiliares')">
                <h3>Documentos Familiares</h3>
                <span>▼</span>
            </div>
            <div id="documentosFamiliares" class="section-content">
                <div class="documento-item">
                    <label for="certidaoNascimento">Certidão de Nascimento/Casamento</label>
                    <input type="file" id="certidaoNascimento" accept=".pdf,.jpg,.png" required>
                </div>
                <div class="documento-item" id="dependentesContainer" style="display: none;">
                    <label for="certidaoFilhos">Certidão de Nascimento dos Filhos</label>
                    <input type="file" id="certidaoFilhos" accept=".pdf,.jpg,.png">
                </div>
                <div class="documento-item" id="cpfDependentesContainer" style="display: none;">
                    <label for="cpfDependentes">CPF dos Dependentes</label>
                    <input type="file" id="cpfDependentes" accept=".pdf,.jpg,.png">
                </div>
                <div class="documento-item" id="vacinaFilhosContainer" style="display: none;">
                    <label for="vacinaFilhos">Carteira de Vacinação dos Filhos</label>
                    <input type="file" id="vacinaFilhos" accept=".pdf,.jpg,.png">
                </div>
            </div>

            <div class="section-title" onclick="toggleSection('documentosResidenciais')">
                <h3>Documentos Residenciais</h3>
                <span>▼</span>
            </div>
            <div id="documentosResidenciais" class="section-content">
                <div class="documento-item">
                    <label for="comprovanteResidencia">Comprovante de Residência</label>
                    <input type="file" id="comprovanteResidencia" accept=".pdf,.jpg,.png" required>
                </div>
            </div>

            <div class="section-title" onclick="toggleSection('outrosDocumentos')">
                <h3>Outros Documentos</h3>
                <span>▼</span>
            </div>
            <div id="outrosDocumentos" class="section-content">
                <div class="documento-item">
                    <label for="foto3x4">Foto 3x4</label>
                    <input type="file" id="foto3x4" accept=".jpg,.png" required>
                </div>
                <div class="documento-item" id="cnhContainer" style="display: none;">
                    <label for="cnh">CNH (se aplicável)</label>
                    <input type="file" id="cnh" accept=".pdf,.jpg,.png">
                </div>
                <div class="documento-item" id="certificadoCursoContainer" style="display: none;">
                    <label for="certificadoCurso">Certificado de Curso Específico</label>
                    <input type="file" id="certificadoCurso" accept=".pdf,.jpg,.png">
                </div>
                <div class="documento-item">
                    <label for="pis">Cartão do PIS</label>
                    <input type="file" id="pis" accept=".pdf,.jpg,.png" required>
                </div>
                <div class="documento-item">
                    <label for="historicoEscolar">Histórico Escolar</label>
                    <input type="file" id="historicoEscolar" accept=".pdf,.jpg,.png">
                </div>
                <div class="documento-item">
                    <label for="vacinaCovid">Comprovante de Vacina - COVID-19</label>
                    <input type="file" id="vacinaCovid" accept=".pdf,.jpg,.png" required>
                </div>
            </div>

            <button id="salvarBtn" class="btn">Salvar Documentos</button>
        </div>

        <!-- Página de Funcionários -->
        <div id="funcionarios" class="container">
            <h2>Funcionários Cadastrados</h2>
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="filtroFuncionarios">Filtrar por Nome</label>
                <input type="text" id="filtroFuncionarios" placeholder="Digite o nome para filtrar...">
            </div>
            <div class="funcionarios-list" id="funcionariosList">
                <!-- Lista será preenchida dinamicamente -->
            </div>
        </div>

        <!-- Página de Documentos do Funcionário -->
        <div id="documentosFuncionario" class="container">
            <button id="voltarBtn" class="btn">Voltar</button>
            <h2 id="nomeFuncionario">Documentos de </h2>
            <div class="documentos-container" id="documentosContainer">
                <!-- Documentos serão listados aqui -->
            </div>
        </div>

        <!-- Página de Controle de Pessoas -->
        <div id="controlePessoas" class="container">
            <h2>Controle de Pessoas</h2>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="novaPessoaNome">Nomes (separados por vírgula)</label>
                    <input type="text" id="novaPessoaNome" required placeholder="Ex: João Silva, Maria Oliveira, Pedro Santos">
                </div>
                <div class="form-group">
                    <label for="novaPessoaCPF">CPFs (opcional, separados por vírgula)</label>
                    <input type="text" id="novaPessoaCPF" placeholder="Somente números, ex: 12345678901,98765432100">
                </div>
                <button id="adicionarPessoaBtn" class="btn">Adicionar Pessoas</button>
            </div>
            
            <div class="form-group">
                <label for="filtroPessoas">Filtrar por Nome</label>
                <input type="text" id="filtroPessoas" placeholder="Digite para filtrar...">
            </div>
            
            <h3>Pessoas Cadastradas</h3>
            <div id="listaPessoas" style="margin-top: 20px;"></div>
            
            <div class="resumo-pessoas">
                <h4>Resumo</h4>
                <p>Total de Pessoas: <span id="totalPessoas">0</span></p>
                <p>Documentos Enviados: <span id="totalEnviados">0</span></p>
                <p>Documentos Pendentes: <span id="totalPendentes">0</span></p>
            </div>
        </div>
    
        <!-- Modal de Senha para Funcionários -->
        <div id="senhaModal" class="modal">
            <div class="modal-content">
                <h3 class="modal-title">Acesso Restrito</h3>
                <p>Digite a senha para acessar a área de funcionários:</p>
                <input type="password" id="senhaAcesso" class="form-group" style="width: 100%;">
                <div class="modal-actions">
                    <button id="cancelarSenhaBtn" class="btn">Cancelar</button>
                    <button id="confirmarSenhaBtn" class="btn">Confirmar</button>
                </div>
            </div>
        </div>
    
        <footer>
            <img src="img/GZL - Logos_pages-to-jpg-0001.jpg" alt="Logo da Empresa" class="footer-logo">
            <p>Sistema de Gestão de Documentos © 2025 - Todos os direitos reservados</p>
        </footer>
    
        <!-- Firebase e Scripts -->
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    
        <script>
            // Configuração do Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyBZE7myNAPADs8yJx8ejr1qnaqV60U-LvU",
                authDomain: "ritmo-44c20.firebaseapp.com",
                databaseURL: "https://ritmo-44c20-default-rtdb.firebaseio.com",
                projectId: "ritmo-44c20",
                storageBucket: "ritmo-44c20.firebasestorage.app",
                messagingSenderId: "784049161032",
                appId: "1:784049161032:web:480bf33cb60e020ca3e97d",
                measurementId: "G-DPYNXD0BNC"
            };
    
            // Inicializa o Firebase
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const database = firebase.database();
            const storage = firebase.storage();
            const funcionariosRef = database.ref('funcionarios');
            const pessoasRef = database.ref('pessoasControle');
    
            // Lista de documentos obrigatórios
            const DOCUMENTOS_OBRIGATORIOS = [
                'rg', 'cpfDoc', 'tituloEleitor', 'reservista', 
                'certidaoNascimento', 'comprovanteResidencia', 
                'foto3x4', 'pis', 'vacinaCovid'
            ];
    
            // Estado da aplicação
            let currentFuncionarioId = null;
            const SENHA_ADMIN = "PWESD233@#&"; // Senha para acessar áreas restritas
    
            // Função para mostrar página específica
            function showPage(pageId) {
                document.querySelectorAll('.container').forEach(page => {
                    page.classList.remove('active');
                });
                document.getElementById(pageId).classList.add('active');
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.querySelector(`.nav-btn[data-page="${pageId}"]`).classList.add('active');
            }
    
            // Alternar seções
            function toggleSection(sectionId) {
                const section = document.getElementById(sectionId);
                const arrow = section.previousElementSibling.querySelector('span');
                
                if (section.style.display === 'none') {
                    section.style.display = 'block';
                    arrow.textContent = '▼';
                } else {
                    section.style.display = 'none';
                    arrow.textContent = '▶';
                }
            }
    
            // Mostrar/ocultar campos condicionais
            function atualizarCamposCondicionais() {
                const cargo = document.getElementById('cargo').value;
                const temDependentes = document.getElementById('temDependentes').value;
                
                // CNH e Curso Específico (apenas para operadores)
                const cnhContainer = document.getElementById('cnhContainer');
                const certificadoCursoContainer = document.getElementById('certificadoCursoContainer');
                
                if (cargo === 'operador') {
                    cnhContainer.style.display = 'block';
                    certificadoCursoContainer.style.display = 'block';
                } else {
                    cnhContainer.style.display = 'none';
                    certificadoCursoContainer.style.display = 'none';
                    document.getElementById('cnh').value = '';
                    document.getElementById('certificadoCurso').value = '';
                }
                
                // Documentos de dependentes
                const dependentesContainer = document.getElementById('dependentesContainer');
                const cpfDependentesContainer = document.getElementById('cpfDependentesContainer');
                const vacinaFilhosContainer = document.getElementById('vacinaFilhosContainer');
                
                if (temDependentes === 'sim') {
                    dependentesContainer.style.display = 'block';
                    cpfDependentesContainer.style.display = 'block';
                    vacinaFilhosContainer.style.display = 'block';
                } else {
                    dependentesContainer.style.display = 'none';
                    cpfDependentesContainer.style.display = 'none';
                    vacinaFilhosContainer.style.display = 'none';
                    document.getElementById('certidaoFilhos').value = '';
                    document.getElementById('cpfDependentes').value = '';
                    document.getElementById('vacinaFilhos').value = '';
                }
            }
    
            // Mostrar mensagem de status
            function showStatusMessage(message, type) {
                const statusElement = document.getElementById('statusMessage');
                statusElement.textContent = message;
                statusElement.className = `status-message ${type}`;
                statusElement.style.display = 'block';
                
                setTimeout(() => {
                    statusElement.style.display = 'none';
                }, 5000);
            }
    
            // Navegação
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (btn.dataset.page === 'funcionarios' || btn.dataset.page === 'controlePessoas') {
                        document.getElementById('senhaModal').style.display = 'flex';
                        document.getElementById('senhaAcesso').value = '';
                        
                        // Configurar temporariamente o botão de confirmação
                        const confirmarBtn = document.getElementById('confirmarSenhaBtn');
                        const originalHandler = confirmarBtn.onclick;
                        
                        confirmarBtn.onclick = function() {
                            const senha = document.getElementById('senhaAcesso').value;
                            if (senha === SENHA_ADMIN) {
                                document.getElementById('senhaModal').style.display = 'none';
                                showPage(btn.dataset.page);
                                document.getElementById('senhaAcesso').value = '';
                                // Restaurar o handler original
                                confirmarBtn.onclick = originalHandler;
                            } else {
                                alert('Senha incorreta!');
                            }
                        };
                    } else {
                        showPage(btn.dataset.page);
                    }
                });
            });
    
            // Modal de Senha
            document.getElementById('cancelarSenhaBtn').addEventListener('click', () => {
                document.getElementById('senhaModal').style.display = 'none';
                document.getElementById('senhaAcesso').value = '';
            });
    
            // Login
            document.getElementById('loginForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('email').value;
                const senha = document.getElementById('senha').value;
                
                auth.signInWithEmailAndPassword(email, senha)
                    .then(() => {
                        document.getElementById('loginContainer').style.display = 'none';
                        document.getElementById('appContainer').style.display = 'block';
                        showPage('cadastro');
                        carregarFuncionarios();
                        carregarListaPessoas();
                    })
                    .catch(error => {
                        alert('Erro ao fazer login: ' + error.message);
                    });
            });
    
            // Logout
            document.getElementById('logoutBtn').addEventListener('click', () => {
                auth.signOut()
                    .then(() => {
                        document.getElementById('loginContainer').style.display = 'flex';
                        document.getElementById('appContainer').style.display = 'none';
                    });
            });
    
            // Voltar para lista de funcionários
            document.getElementById('voltarBtn').addEventListener('click', () => {
                showPage('funcionarios');
            });
    
            // Event listeners para campos condicionais
            document.getElementById('cargo').addEventListener('change', atualizarCamposCondicionais);
            document.getElementById('temDependentes').addEventListener('change', atualizarCamposCondicionais);
    
            // Salvar documentos
            document.getElementById('salvarBtn').addEventListener('click', async () => {
                const nome = document.getElementById('nome').value;
                const cpf = document.getElementById('cpf').value;
                const cargo = document.getElementById('cargo').value;
                const temDependentes = document.getElementById('temDependentes').value;
                
                if (!nome || !cpf || !cargo || !temDependentes) {
                    showStatusMessage('Por favor, preencha todos os campos obrigatórios', 'error');
                    return;
                }
                
                const funcionarioData = {
                    nome,
                    cpf,
                    cargo,
                    temDependentes,
                    dataCadastro: new Date().toISOString(),
                    documentos: {}
                };
                
                try {
                    // Processa cada documento
                    for (const docId of DOCUMENTOS_OBRIGATORIOS) {
                        const fileInput = document.getElementById(docId);
                        if (fileInput && fileInput.files.length > 0) {
                            const file = fileInput.files[0];
                            const base64 = await fileParaBase64(file);
                            
                            funcionarioData.documentos[docId] = {
                                nome: file.name,
                                tipo: file.type,
                                tamanho: file.size,
                                data: base64,
                                dataUpload: new Date().toISOString()
                            };
                        }
                    }
                    
                    // Processa documentos adicionais condicionais
                    const DOCUMENTOS_ADICIONAIS = [
                        'certidaoFilhos', 'cpfDependentes', 'vacinaFilhos',
                        'cnh', 'certificadoCurso', 'historicoEscolar'
                    ];
                    
                    for (const docId of DOCUMENTOS_ADICIONAIS) {
                        const fileInput = document.getElementById(docId);
                        if (fileInput && fileInput.files.length > 0) {
                            const file = fileInput.files[0];
                            const base64 = await fileParaBase64(file);
                            
                            funcionarioData.documentos[docId] = {
                                nome: file.name,
                                tipo: file.type,
                                tamanho: file.size,
                                data: base64,
                                dataUpload: new Date().toISOString()
                            };
                        }
                    }
                    
                    // Salva no Firebase
                    await funcionariosRef.push().set(funcionarioData);
                    
                    showStatusMessage('Documentos salvos com sucesso!', 'success');
                    
                    // Limpa o formulário
                    document.getElementById('nome').value = '';
                    document.getElementById('cpf').value = '';
                    document.getElementById('cargo').value = '';
                    document.getElementById('temDependentes').value = '';
                    
                    const todosDocumentos = [...DOCUMENTOS_OBRIGATORIOS, ...DOCUMENTOS_ADICIONAIS];
                    todosDocumentos.forEach(docId => {
                        const input = document.getElementById(docId);
                        if (input) input.value = '';
                    });
                    
                    // Atualiza a lista
                    carregarFuncionarios();
                    
                } catch (error) {
                    console.error('Erro ao salvar documentos:', error);
                    showStatusMessage('Erro ao salvar documentos: ' + error.message, 'error');
                }
            });
    
            // Carrega lista de funcionários
            function carregarFuncionarios() {
                funcionariosRef.on('value', snapshot => {
                    const funcionariosList = document.getElementById('funcionariosList');
                    funcionariosList.innerHTML = '';
                    
                    snapshot.forEach(childSnapshot => {
                        const funcionario = childSnapshot.val();
                        const funcionarioId = childSnapshot.key;
                        
                        // Calcula documentos entregues
                        const docsEntregues = funcionario.documentos ? 
                            Object.keys(funcionario.documentos).length : 0;
                        const percentual = Math.round(
                            (docsEntregues / DOCUMENTOS_OBRIGATORIOS.length) * 100
                        );
                        
                        // Cria o card do funcionário
                        const card = document.createElement('div');
                        card.className = 'funcionario-card';
                        card.innerHTML = `
                            <h3>${funcionario.nome}</h3>
                            <p>CPF: ${funcionario.cpf}</p>
                            <p>Cargo: ${formatarCargo(funcionario.cargo)}</p>
                            
                            <div class="progress-bar">
                                <div class="progress" style="width: ${percentual}%"></div>
                            </div>
                            <p>${percentual}% completo</p>
                        `;
                        
                        // Botão para ver documentos
                        const verBtn = document.createElement('button');
                        verBtn.className = 'download-btn';
                        verBtn.textContent = 'Ver Documentos';
                        verBtn.addEventListener('click', () => {
                            currentFuncionarioId = funcionarioId;
                            document.getElementById('nomeFuncionario').textContent = `Documentos de ${funcionario.nome}`;
                            mostrarDocumentosFuncionario(funcionario);
                            showPage('documentosFuncionario');
                        });
                        
                        card.appendChild(verBtn);
                        funcionariosList.appendChild(card);
                    });
                });
            }
    
            // Configurar filtro de funcionários
            document.getElementById('filtroFuncionarios').addEventListener('input', function(e) {
                const filtro = e.target.value.toLowerCase();
                const cards = document.querySelectorAll('.funcionario-card');
                
                cards.forEach(card => {
                    const nome = card.querySelector('h3').textContent.toLowerCase();
                    card.style.display = nome.includes(filtro) ? 'block' : 'none';
                });
            });
    
            // Mostra documentos de um funcionário específico
            function mostrarDocumentosFuncionario(funcionario) {
                const documentosContainer = document.getElementById('documentosContainer');
                documentosContainer.innerHTML = '';
                
                if (!funcionario.documentos) {
                    documentosContainer.innerHTML = '<p>Nenhum documento cadastrado</p>';
                    return;
                }
                
                // Ordena documentos por categoria
                const categorias = {
                    'Pessoais': ['rg', 'cpfDoc', 'tituloEleitor', 'reservista'],
                    'Familiares': ['certidaoNascimento', 'certidaoFilhos', 'cpfDependentes', 'vacinaFilhos'],
                    'Residenciais': ['comprovanteResidencia'],
                    'Profissionais': ['pis', 'cnh', 'certificadoCurso', 'historicoEscolar'],
                    'Outros': ['foto3x4', 'vacinaCovid']
                };
                
                for (const [categoria, docs] of Object.entries(categorias)) {
                    const docsExistentes = docs.filter(doc => funcionario.documentos[doc]);
                    
                    if (docsExistentes.length > 0) {
                        const categoriaElement = document.createElement('div');
                        categoriaElement.innerHTML = `<h3>${categoria}</h3>`;
                        documentosContainer.appendChild(categoriaElement);
                        
                        docsExistentes.forEach(docId => {
                            const docData = funcionario.documentos[docId];
                            const docElement = document.createElement('div');
                            docElement.className = 'documento-view';
                            docElement.innerHTML = `
                                <p><strong>${getDocumentName(docId)}</strong></p>
                                <p>Arquivo: ${docData.nome}</p>
                                <p>Tamanho: ${formatBytes(docData.tamanho)}</p>
                                <p>Data: ${new Date(docData.dataUpload).toLocaleDateString()}</p>
                                <a href="${docData.data}" download="${docData.nome}" class="download-btn">Baixar Documento</a>
                            `;
                            documentosContainer.appendChild(docElement);
                        });
                    }
                }
            }
    
            // Controle de Pessoas - Adicionar nova pessoa
            document.getElementById('adicionarPessoaBtn').addEventListener('click', function() {
                const nomeInput = document.getElementById('novaPessoaNome');
                const cpfInput = document.getElementById('novaPessoaCPF');
                
                const nomes = nomeInput.value.trim().split(',').map(n => n.trim()).filter(n => n);
                const cpfs = cpfInput.value.trim().split(',').map(c => c.trim().replace(/\D/g, '')).filter(c => c);
                
                if (nomes.length === 0) {
                    alert('Por favor, informe pelo menos um nome');
                    return;
                }
                
                // Verificar se o número de CPFs corresponde (se foram fornecidos)
                if (cpfs.length > 0 && cpfs.length !== nomes.length) {
                    alert('O número de CPFs deve corresponder ao número de nomes ou ser deixado em branco');
                    return;
                }
                
                // Adicionar cada pessoa ao banco de dados
                nomes.forEach((nome, index) => {
                    const pessoaData = {
                        nome: nome,
                        dataCadastro: new Date().toISOString()
                    };
                    
                    // Adicionar CPF se existir na posição correspondente
                    if (cpfs[index] && cpfs[index].length === 11) {
                        pessoaData.cpf = cpfs[index];
                    } else if (cpfs[index]) {
                        alert(`CPF ${cpfs[index]} inválido (deve ter 11 dígitos). Será cadastrado sem CPF.`);
                    }
                    
                    pessoasRef.push(pessoaData)
                        .catch(error => {
                            console.error('Erro ao cadastrar pessoa:', error);
                            alert('Erro ao cadastrar pessoa: ' + error.message);
                        });
                });
                
                // Limpar os campos após cadastro
                nomeInput.value = '';
                cpfInput.value = '';
            });
    
            // Configurar filtro de pessoas
            document.getElementById('filtroPessoas').addEventListener('input', function(e) {
                const filtro = e.target.value.toLowerCase();
                carregarListaPessoas(filtro);
            });
    
            // Carregar lista de pessoas com filtro
            function carregarListaPessoas(filtro = '') {
                pessoasRef.on('value', function(snapshot) {
                    const listaPessoas = document.getElementById('listaPessoas');
                    listaPessoas.innerHTML = '';
                    
                    let totalPessoas = 0;
                    let totalEnviados = 0;
                    let totalPendentes = 0;
                    
                    // Processar cada pessoa
                    snapshot.forEach(function(childSnapshot) {
                        const pessoa = childSnapshot.val();
                        const pessoaId = childSnapshot.key;
                        
                        // Aplicar filtro se existir
                        if (filtro && !pessoa.nome.toLowerCase().includes(filtro)) {
                            return;
                        }
                        
                        totalPessoas++;
                        
                        // Criar card da pessoa
                        const card = document.createElement('div');
                        card.className = 'pessoa-card';
                        card.innerHTML = `
                            <h4>${pessoa.nome}</h4>
                            ${pessoa.cpf ? `<p>CPF: ${formatarCPF(pessoa.cpf)}</p>` : ''}
                            <p>Cadastrado em: ${formatarData(pessoa.dataCadastro)}</p>
                            <div class="pessoa-actions">
                                <button class="btn-remover" data-id="${pessoaId}">Remover</button>
                            </div>
                        `;
                        
                        listaPessoas.appendChild(card);
                        
                        // Verificar se já enviou documentos (assíncrono)
                        verificarDocumentosEnviados(pessoa.nome, pessoa.cpf).then(enviou => {
                            const statusElement = document.createElement('p');
                            statusElement.innerHTML = `Status: <span class="${enviou ? 'status-enviado' : 'status-pendente'}">${
                                enviou ? 'Documentos Enviados' : 'Documentos Pendentes'
                            }</span>`;
                            
                            // Inserir após o nome
                            const nomeElement = card.querySelector('h4');
                            nomeElement.insertAdjacentElement('afterend', statusElement);
                            
                            // Atualizar contadores
                            if (enviou) totalEnviados++;
                            else totalPendentes++;
                            
                            document.getElementById('totalEnviados').textContent = totalEnviados;
                            document.getElementById('totalPendentes').textContent = totalPendentes;
                        });
                    });
                    
                    // Atualizar totais
                    document.getElementById('totalPessoas').textContent = totalPessoas;
                    
                    // Configurar botões de remoção
                    document.querySelectorAll('.btn-remover').forEach(btn => {
                        btn.addEventListener('click', function() {
                            if (confirm(`Tem certeza que deseja remover esta pessoa da lista?`)) {
                                pessoasRef.child(btn.dataset.id).remove();
                            }
                        });
                    });
                });
            }
    
            // Verificar se documentos foram enviados
            async function verificarDocumentosEnviados(nome, cpf) {
                try {
                    const snapshot = await funcionariosRef.once('value');
                    let encontrou = false;
                    
                    snapshot.forEach(childSnapshot => {
                        const funcionario = childSnapshot.val();
                        
                        // Verificar por nome (case insensitive) ou CPF
                        if (funcionario.nome.toLowerCase() === nome.toLowerCase() || 
                            (cpf && funcionario.cpf === cpf)) {
                            encontrou = true;
                        }
                    });
                    
                    return encontrou;
                } catch (error) {
                    console.error('Erro ao verificar documentos:', error);
                    return false;
                }
            }
    
            // Funções auxiliares
            function formatarCPF(cpf) {
                if (!cpf) return '';
                return cpf.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
            }
    
            function formatarData(dataString) {
                const data = new Date(dataString);
                return data.toLocaleDateString('pt-BR');
            }

            function formatarCargo(cargo) {
                const cargos = {
                    'operador': 'Operador',
                    'auxiliar': 'Auxiliar',
                    'administrativo': 'Administrativo',
                    'supervisor': 'Supervisor',
                    'gerente': 'Gerente'
                };
                return cargos[cargo] || cargo;
            }
    
            // Converte arquivo para Base64
            function fileParaBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = error => reject(error);
                });
            }
    
            // Formata bytes para tamanho legível
            function formatBytes(bytes, decimals = 2) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const dm = decimals < 0 ? 0 : decimals;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
            }
    
            // Retorna nome amigável para o documento
            function getDocumentName(docId) {
                const names = {
                    'rg': 'RG',
                    'cpfDoc': 'CPF',
                    'tituloEleitor': 'Título de Eleitor',
                    'reservista': 'Certidão de Reservista',
                    'certidaoNascimento': 'Certidão de Nascimento/Casamento',
                    'certidaoFilhos': 'Certidão de Nascimento dos Filhos',
                    'cpfDependentes': 'CPF dos Dependentes',
                    'vacinaFilhos': 'Carteira de Vacinação dos Filhos',
                    'comprovanteResidencia': 'Comprovante de Residência',
                    'foto3x4': 'Foto 3x4',
                    'cnh': 'CNH',
                    'certificadoCurso': 'Certificado de Curso',
                    'pis': 'Cartão do PIS',
                    'historicoEscolar': 'Histórico Escolar',
                    'vacinaCovid': 'Comprovante de Vacina - COVID-19'
                };
                return names[docId] || docId;
            }
    
            // Verifica autenticação
            auth.onAuthStateChanged(user => {
                if (user) {
                    document.getElementById('loginContainer').style.display = 'none';
                    document.getElementById('appContainer').style.display = 'block';
                    showPage('cadastro');
                    carregarFuncionarios();
                    carregarListaPessoas();
                }
            });

            // Inicializar seções como expandidas
            document.addEventListener('DOMContentLoaded', function() {
                const sections = ['documentosPessoais', 'documentosFamiliares', 'documentosResidenciais', 'outrosDocumentos'];
                sections.forEach(section => {
                    document.getElementById(section).style.display = 'block';
                });
            });
        </script>
    </body>
    </html>